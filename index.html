<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>利中中爱文化中心 - LIZHONG Chinese-Irish Culture Centre</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif; }
        :root {
            --primary: #3498db; --primary-dark: #2980b9; --secondary: #2ecc71; --accent: #e74c3c;
            --light: #f8f9fa; --dark: #2c3e50; --gray: #95a5a6; --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }
        body { background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); color: var(--dark); line-height: 1.6; min-height: 100vh; padding: 20px; }
        
        /* 欢迎动画样式 */
        .welcome-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #de2910 0%, #169b62 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            opacity: 1;
            transition: opacity 1s ease;
        }
        
        .welcome-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .welcome-content {
            text-align: center;
            color: white;
            padding: 20px;
            max-width: 90%;
        }
        
        .chinese-title {
            font-family: 'Ma Shan Zheng', cursive;
            font-size: 4rem;
            color: #ffde59;
            text-shadow: 3px 3px 5px rgba(0, 0, 0, 0.5);
            margin-bottom: 20px;
            letter-spacing: 5px;
            animation: fadeInUp 1.5s ease;
        }
        
        .english-title {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 2.5rem;
            color: #ffffff;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            margin-bottom: 40px;
            font-weight: bold;
            letter-spacing: 2px;
            animation: fadeInUp 2s ease;
        }
        
        .cultural-elements {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 30px 0;
            animation: fadeIn 2.5s ease;
        }
        
        .dragon {
            font-size: 4rem;
            color: #ffde59;
            margin: 0 20px;
            animation: float 3s ease-in-out infinite;
        }
        
        .shamrock {
            font-size: 4rem;
            color: #ffffff;
            margin: 0 20px;
            animation: float 3s ease-in-out infinite 0.5s;
        }
        
        .enter-button {
            padding: 15px 40px;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid white;
            border-radius: 50px;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
            animation: fadeIn 3s ease;
        }
        
        .enter-button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes fadeInUp {
            from { 
                opacity: 0;
                transform: translateY(30px);
            }
            to { 
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes float {
            0% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
            100% { transform: translateY(0); }
        }
        
        /* 主网站样式 */
        .container { max-width: 1200px; margin: 0 auto; }
        
        /* 网站头部信息样式 */
        .site-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            box-shadow: var(--shadow);
            flex-wrap: wrap;
        }
        
        .time-info {
            font-size: 1.1rem;
            color: var(--dark);
            font-weight: 500;
        }
        
        .visitor-count {
            font-size: 1.1rem;
            color: var(--primary);
            font-weight: 600;
        }
        
        .visitor-count i {
            margin-right: 5px;
            color: var(--accent);
        }
        
        header { 
            text-align: center; 
            margin-bottom: 40px; 
            padding: 30px; 
            background: rgba(255, 255, 255, 0.95); 
            border-radius: 15px; 
            box-shadow: var(--shadow); 
            position: relative; 
            overflow: hidden; 
        }
        header::before { 
            content: ''; 
            position: absolute; 
            top: 0; 
            left: 0; 
            right: 0; 
            height: 5px; 
            background: linear-gradient(90deg, var(--primary), var(--secondary), var(--accent)); 
        }
        
        /* 更新标题样式 */
        .site-header {
            margin-bottom: 15px;
        }
        
        .site-chinese-title {
            font-family: 'Ma Shan Zheng', cursive;
            font-size: 2.8rem;
            color: #de2910;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .site-english-title {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 1.8rem;
            color: #169b62;
            margin-bottom: 15px;
            font-weight: bold;
            letter-spacing: 1px;
        }
        
        .subtitle { 
            color: var(--gray); 
            font-size: 1.3rem; 
            margin-bottom: 20px; 
        }

        .lesson-title {
            font-size: 0.75rem;
            color: #7f8c8d;
            margin-top: 3px;
            font-style: italic;
        }

        .unit-topic {
            font-size: 0.85rem;
            color: #3498db;
            margin-bottom: 8px;
            font-weight: 500;
            padding: 5px;
            background: #e8f4fd;
            border-radius: 4px;
        }

        .lesson-header {
            position: relative;
            cursor: pointer;
            padding: 5px;
        }

        .games-toggle {
            position: absolute;
            right: 5px;
            top: 50%;
            transform: translateY(-50%);
            transition: var(--transition);
            color: var(--gray);
        }

        .games-toggle.rotated {
            transform: translateY(-50%) rotate(180deg);
        }

        .games-container {
            max-height: 0;
            overflow: hidden;
            transition: var(--transition);
            background: #f8f9fa;
            border-radius: 4px;
            margin-top: 5px;
            opacity: 0;
        }

        .games-container.expanded {
            max-height: none;
            padding: 8px;
            opacity: 1;
        }

        .games-title {
            font-size: 0.75rem;
            color: var(--dark);
            font-weight: 600;
            margin-bottom: 5px;
            padding-bottom: 3px;
            border-bottom: 1px solid #e1e8ed;
        }

        .game-link {
            display: block;
            padding: 5px 8px;
            margin: 3px 0;
            background: #e8f4fd;
            border-radius: 4px;
            color: #2980b9;
            text-decoration: none;
            font-size: 0.8rem;
            transition: all 0.2s ease;
        }

        .game-link:hover {
            background: #3498db;
            color: white;
            transform: translateX(5px);
        }

        .game-link i {
            margin-right: 5px;
        }

        .game-type {
            float: right;
            font-size: 0.7rem;
            background: #2ecc71;
            color: white;
            padding: 1px 5px;
            border-radius: 10px;
        }
        
        .search-container { max-width: 600px; margin: 0 auto; position: relative; }
        #searchInput { width: 100%; padding: 15px 20px; border: 2px solid #e1e8ed; border-radius: 50px; font-size: 1.1rem; transition: var(--transition); }
        #searchInput:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2); }
        .filter-container { display: flex; justify-content: center; flex-wrap: wrap; gap: 15px; margin: 25px 0; }
        .filter-btn { padding: 10px 20px; background: white; border: 2px solid #e1e8ed; border-radius: 30px; cursor: pointer; transition: var(--transition); font-weight: 600; color: var(--dark); }
        .filter-btn:hover, .filter-btn.active { background: var(--primary); color: white; border-color: var(--primary); }
        
        /* 动态调整教材容器布局 */
        .textbooks-container { 
            display: grid; 
            gap: 25px; 
            transition: var(--transition);
        }
        
        /* 显示全部教材时的布局（3列） */
        .textbooks-container.all-textbooks {
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        }
        
        /* 显示较少教材时的布局（2列，更宽） */
        .textbooks-container.few-textbooks {
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
        }
        
        /* 显示单个教材时的布局（1列，最宽） */
        .textbooks-container.single-textbook {
            grid-template-columns: 1fr;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .textbook-card { 
            background: white; 
            border-radius: 15px; 
            overflow: hidden; 
            box-shadow: var(--shadow); 
            transition: var(--transition); 
        }
        .textbook-card:hover { transform: translateY(-10px); box-shadow: 0 12px 25px rgba(0, 0, 0, 0.15); }
        .textbook-header { background: var(--primary); color: white; padding: 20px; position: relative; }
        .textbook-header h2 { font-size: 1.5rem; margin-bottom: 5px; }
        .textbook-count { font-size: 0.9rem; opacity: 0.9; }
        .textbook-icon { position: absolute; right: 20px; top: 50%; transform: translateY(-50%); font-size: 2.5rem; opacity: 0.2; }
        .volumes-container { padding: 20px; max-height: 400px; overflow-y: auto; }
        .volume-item { margin-bottom: 15px; border: 1px solid #e1e8ed; border-radius: 10px; overflow: hidden; }
        .volume-header { background: #f8f9fa; padding: 12px 15px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; transition: var(--transition); }
        .volume-header:hover { background: #e9ecef; }
        .volume-header h3 { font-size: 1.1rem; color: var(--dark); }
        .volume-toggle { transition: var(--transition); }
        .volume-toggle.rotated { transform: rotate(180deg); }
        .units-container { padding: 0 15px; max-height: 0; overflow: hidden; transition: var(--transition); }
        .units-container.expanded { max-height: none; padding: 15px; }
        .unit-item { margin-bottom: 12px; padding: 10px; background: #f8f9fa; border-radius: 8px; }
        .unit-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .unit-name { font-weight: 600; color: var(--dark); }
        .lessons-count { font-size: 0.8rem; color: var(--gray); background: white; padding: 3px 8px; border-radius: 20px; }
        
        /* 修改课程容器布局 - 自动均匀排列 */
        .lessons-container { 
            display: grid; 
            gap: 8px; 
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
        }
        
        .lesson-item { 
            background: white; 
            padding: 8px 5px; 
            text-align: center; 
            border-radius: 6px; 
            font-size: 0.85rem; 
            transition: var(--transition); 
            cursor: pointer; 
            border: 1px solid #e1e8ed; 
            position: relative;
            min-height: 60px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        .lesson-item:not(.has-games):hover { 
            background: var(--primary); 
            color: white; 
            transform: scale(1.05); 
        }
        
        .empty-lessons { text-align: center; color: var(--gray); font-style: italic; padding: 10px; }
        footer { text-align: center; margin-top: 50px; padding: 20px; color: var(--gray); font-size: 0.9rem; }
        .loading, .no-results { text-align: center; padding: 40px; font-size: 1.2rem; color: var(--gray); }
        .no-results { grid-column: 1 / -1; }
        
        @media (max-width: 768px) {
            .textbooks-container.all-textbooks,
            .textbooks-container.few-textbooks,
            .textbooks-container.single-textbook {
                grid-template-columns: 1fr;
            }
            .lessons-container {
                grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            }
            .site-chinese-title { font-size: 2.2rem; }
            .site-english-title { font-size: 1.4rem; }
            .chinese-title { font-size: 2.5rem; }
            .english-title { font-size: 1.5rem; }
            .dragon, .shamrock { font-size: 2.5rem; }
            .filter-container { flex-direction: column; align-items: center; }
            .filter-btn { width: 100%; max-width: 250px; }
            .site-info {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <!-- 欢迎动画 -->
    <div class="welcome-overlay" id="welcomeOverlay">
        <div class="welcome-content">
            <h1 class="chinese-title">利中中爱文化中心</h1>
            <h2 class="english-title">LIZHONG Chinese-Irish Culture Centre</h2>
            <div class="cultural-elements">
                <div class="dragon">🐉</div>
                <div class="shamrock">☘️</div>
            </div>
            <button class="enter-button" id="enterButton">进入网站</button>
        </div>
    </div>

    <!-- 主网站内容 -->
    <div class="container" id="mainContent" style="display: none;">
        <!-- 网站信息栏 -->
        <div class="site-info">
            <div class="time-info">
                <i class="fas fa-clock"></i>
                <span id="currentTime">正在加载时间...</span>
            </div>
            <div class="visitor-count">
                <i class="fas fa-users"></i>
                网站访问人数: <span id="visitorCount">0</span>
            </div>
        </div>
        
        <header>
            <div class="site-header">
                <h1 class="site-chinese-title">利中中爱文化中心</h1>
                <h2 class="site-english-title">LIZHONG Chinese-Irish Culture Centre</h2>
            </div>
            <p class="subtitle">中文教学游戏资源库</p>
            <div class="search-container">
                <input type="text" id="searchInput" placeholder="搜索教材、单元或课程...">
            </div>
            <div class="filter-container">
                <button class="filter-btn active" data-filter="all">全部教材</button>
                <button class="filter-btn" data-filter="欧洲版">中文（小学·欧洲版）</button>
                <button class="filter-btn" data-filter="暨南大学版">中文（小学·暨南大学版）</button>
                <button class="filter-btn" data-filter="华文">华文（小学·北京华文学院版）</button>
                <button class="filter-btn" data-filter="YCT">YCT标准教程</button>
                <button class="filter-btn" data-filter="幼儿汉语">幼儿汉语</button>
                <button class="filter-btn" data-filter="汉语拼音">汉语拼音</button>
            </div>
        </header>
        <main class="textbooks-container all-textbooks" id="textbooksContainer">
            <div class="loading"><i class="fas fa-spinner fa-spin"></i> 加载教材数据中...</div>
        </main>
        <footer>
            <p>© 2023 利中中爱文化中心 | 中文教学游戏资源库</p>
        </footer>
    </div>

    <script>
        // 欢迎动画控制
        document.addEventListener('DOMContentLoaded', function() {
            const welcomeOverlay = document.getElementById('welcomeOverlay');
            const enterButton = document.getElementById('enterButton');
            const mainContent = document.getElementById('mainContent');
            
            // 点击进入按钮
            enterButton.addEventListener('click', function() {
                welcomeOverlay.classList.add('hidden');
                setTimeout(function() {
                    mainContent.style.display = 'block';
                    // 初始化主网站内容
                    initMainWebsite();
                }, 1000);
            });
            
            // 5秒后自动进入网站
            setTimeout(function() {
                if (!welcomeOverlay.classList.contains('hidden')) {
                    enterButton.click();
                }
            }, 5000);
        });
        
        // 更新时间和日期
        function updateDateTime() {
            const now = new Date();
            const options = { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric', 
                weekday: 'long',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            };
            const dateTimeStr = now.toLocaleDateString('zh-CN', options);
            document.getElementById('currentTime').textContent = dateTimeStr;
        }
        
        // 更新访问人数
        function updateVisitorCount() {
            // 从localStorage获取访问次数
            let visitCount = localStorage.getItem('siteVisitCount');
            
            if (!visitCount) {
                visitCount = 1;
            } else {
                visitCount = parseInt(visitCount) + 1;
            }
            
            // 保存到localStorage
            localStorage.setItem('siteVisitCount', visitCount);
            
            // 显示访问人数
            document.getElementById('visitorCount').textContent = visitCount;
        }
        
        // 调整教材容器布局
        function adjustTextbooksLayout(data) {
            const container = document.getElementById('textbooksContainer');
            const textbookCount = data.length;
            
            // 移除所有布局类
            container.classList.remove('all-textbooks', 'few-textbooks', 'single-textbook');
            
            // 根据教材数量应用不同的布局
            if (textbookCount >= 4) {
                container.classList.add('all-textbooks'); // 3列布局
            } else if (textbookCount >= 2) {
                container.classList.add('few-textbooks'); // 2列布局
            } else if (textbookCount === 1) {
                container.classList.add('single-textbook'); // 1列布局
            } else {
                container.classList.add('all-textbooks'); // 默认布局
            }
        }
        
        // 初始化主网站
        function initMainWebsite() {
            // 更新时间和访问人数
            updateDateTime();
            updateVisitorCount();
            
            // 每秒更新时间
            setInterval(updateDateTime, 1000);
            
            // 完整的教材数据 - 为华文第三册添加第一单元和第三单元的缺失课程
            const completeTextbooksData = [
                {
                    "name": "中文（小学·欧洲版）",
                    "icon": "fas fa-globe-europe",
                    "volumes": [
                        {
                            "name": "第一册",
                            "units": [
                                {"name": "第一单元", "topic": "有趣的象形字","lessons": []},
                                {"name": "第二单元", "topic": "有趣的会意字", "lessons": []},
                                {
                                    "name": "第三单元",
                                    "lessons": [
                                        {"name": "第一课","topic": "早"}, {"name": "第二课","topic": "你好"}, {"name": "第三课","topic": "你几岁了"}, {"name": "第四课","topic": "拼音复习1"}
                                    ]
                                },
                                {
                                    "name": "第四单元",
                                    "lessons": [
                                        {"name": "第五课","topic": "你是哪国人"}, 
                                        {"name": "第六课","topic": "你吃什么"}, 
                                        {
                                            "name": "第七课",
                                            "topic": "在做什么", 
                                            "games": [
                                                {
                                                    "name": "Quizlet词卡",
                                                    "url": "https://quizlet.com/ie/1088089621/%E7%AC%AC%E5%9B%9B%E5%8D%95%E5%85%83-%E5%A5%BD%E7%8E%A9%E7%9A%84%E6%8B%BC%E9%9F%B32-7%E5%9C%A8%E5%81%9A%E4%BB%80%E4%B9%88-flash-cards/?i=3vrcho&x=1jqt",
                                                    "type": "词语记忆"
                                                }
                                            ]
                                        }, 
                                        {"name": "第八课","topic": "拼音复习2"}
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "第二册",
                            "units": [
                                {"name": "第一单元",  "topic": "有趣的形声字", "lessons": []},
                                {
                                    "name": "第二单元",  "topic": "我的家庭",
                                    "lessons": [
                                        {"name": "第一课", "topic": "我的一家"}, {"name": "第二课", "topic": "欢迎来我家"}, {"name": "第三课", "topic": "好多玩具"}, {"name": "第四课", "topic": "我能出去玩吗"}
                                    ]
                                },
                                {"name": "第三单元", "topic": "我的学校", "lessons": []},
                                {
                                    "name": "第四单元", "topic": "我的生活",
                                    "lessons": [
                                        {"name": "第五课", "topic": "今天星期几"}, {"name": "第六课", "topic": "动物和我们"}, {"name": "第七课", "topic": "好吃吗"}, {"name": "第八课", "topic": "东西南北"}
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "第三册",
                            "units": [
                                {
                                    "name": "第一单元", "topic": "生日聚会",
                                    "lessons": [
                                        {"name": "第一课", "topic": "十二生肖"}, {"name": "第二课", "topic": "祝你生日快乐"}, {"name": "第三课", "topic": "多彩的贺卡"}, {"name": "第四课", "topic": "生日聚会"}
                                    ]
                                },
                                {
                                    "name": "第二单元", "topic": "走进自然",
                                    "lessons": [
                                        {"name": "第五课", "topic": "迷人的夏天"}, {"name": "第六课", "topic": "云房子"}, {"name": "第七课", "topic": "过冬的好办法"}, {"name": "第八课", "topic": "会上树的鱼"}
                                    ]
                                },
                                {
                                    "name": "第三单元", "topic": "旅游攻略",
                                    "lessons": [
                                        {"name": "第九课", "topic": "去旅行吧"}, {"name": "第十课", "topic": "东方明珠"}, {"name": "第十一课", "topic": "问路"}, {"name": "第十二课", "topic": "旅游见闻"}
                                    ]
                                },
                                {
                                    "name": "第四单元", "topic": "成语大观",
                                    "lessons": [
                                        {"name": "第十三课", "topic": "望梅止渴"}, {"name": "第十四课", "topic": "画龙点睛"}, {"name": "第十五课", "topic": "坐井观天"}, {"name": "第十六课", "topic": "八仙过海 各显神通"}
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "第四册",
                            "units": [
                                {
                                    "name": "第一单元", "topic": "饮食文化",
                                    "lessons": [
                                        {"name": "第一课", "topic": "中西餐具大不同"}, {"name": "第二课", "topic": "筷子的传说"}, {"name": "第三课", "topic": "中华美食大荟萃"}, {"name": "第四课", "topic": "啊，汤圆"}
                                    ]
                                },
                                {
                                    "name": "第二单元", "topic": "自然景观",
                                    "lessons": [
                                        {"name": "第五课", "topic": "中华名山"}, {"name": "第六课", "topic": "中华名湖"}, {"name": "第七课", "topic": "迷人的鸣沙山"}, {"name": "第八课", "topic": "南极风光"}
                                    ]
                                },
                                {
                                    "name": "第三单元", "topic": "传统节日",
                                    "lessons": [
                                        {"name": "第九课", "topic": "中国传统节日"}, {"name": "第十课", "topic": "中国年"}, {"name": "第十一课", "topic": "七夕节"}, {"name": "第十二课", "topic": "唐人街"}
                                    ]
                                },
                                {
                                    "name": "第四单元", "topic": "神话传说",
                                    "lessons": [
                                        {"name": "第十三课", "topic": "女娲造人"}, {"name": "第十四课", "topic": "后羿射日"}, {"name": "第十五课", "topic": "智慧女神雅典娜"}, {"name": "第十六课", "topic": "聪明的渔夫"}
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "第五册",
                            "units": [
                                {
                                    "name": "第一单元", "topic": "饮食文化",
                                    "lessons": [
                                        {"name": "第一课", "topic": "饮食文化"}, {"name": "第二课", "topic": "饮食文化"}, {"name": "第三课", "topic": "饮食文化"}, {"name": "第四课", "topic": "饮食文化"}
                                    ]
                                },
                                {
                                    "name": "第二单元", "topic": "饮食文化",
                                    "lessons": [
                                        {"name": "第五课", "topic": "饮食文化"}, {"name": "第六课", "topic": "饮食文化"}, {"name": "第七课", "topic": "饮食文化"}, {"name": "第八课", "topic": "饮食文化"}
                                    ]
                                },
                                {
                                    "name": "第三单元", "topic": "饮食文化",
                                    "lessons": [
                                        {"name": "第九课", "topic": "饮食文化"}, {"name": "第十课", "topic": "饮食文化"}, {"name": "第十一课", "topic": "饮食文化"}, {"name": "第十二课", "topic": "饮食文化"}
                                    ]
                                },
                                {
                                    "name": "第四单元", "topic": "饮食文化",
                                    "lessons": [
                                        {"name": "第十三课", "topic": "饮食文化"}, {"name": "第十四课", "topic": "饮食文化"}, {"name": "第十五课", "topic": "饮食文化"}, {"name": "第十六课", "topic": "饮食文化"}
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "第六册",
                            "units": [
                                {
                                    "name": "第一单元", "topic": "饮食文化",
                                    "lessons": [
                                        {"name": "第一课", "topic": "饮食文化"}, {"name": "第二课", "topic": "饮食文化"}, {"name": "第三课", "topic": "饮食文化"}, {"name": "第四课", "topic": "饮食文化"}
                                    ]
                                },
                                {
                                    "name": "第二单元", "topic": "饮食文化",
                                    "lessons": [
                                        {"name": "第五课", "topic": "饮食文化"}, {"name": "第六课", "topic": "饮食文化"}, {"name": "第七课", "topic": "饮食文化"}, {"name": "第八课", "topic": "饮食文化"}
                                    ]
                                },
                                {
                                    "name": "第三单元", "topic": "饮食文化",
                                    "lessons": [
                                        {"name": "第九课", "topic": "饮食文化"}, {"name": "第十课", "topic": "饮食文化"}, {"name": "第十一课", "topic": "饮食文化"}, {"name": "第十二课", "topic": "饮食文化"}
                                    ]
                                },
                                {
                                    "name": "第四单元", "topic": "饮食文化",
                                    "lessons": [
                                        {"name": "第十三课", "topic": "饮食文化"}, {"name": "第十四课", "topic": "饮食文化"}, {"name": "第十五课", "topic": "饮食文化"}, {"name": "第十六课", "topic": "饮食文化"}
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "中文（小学·暨南大学版）",
                    "icon": "fas fa-university",
                    "volumes": [
                        {
                            "name": "第一册",
                            "units": [
                                {
                                    "name": "第一单元",
                                    "lessons": [
                                        {"name": "第一课", "topic": "饮食文化"}, {"name": "第二课", "topic": "饮食文化"}, {"name": "第三课", "topic": "饮食文化"}
                                    ]
                                },
                                {
                                    "name": "第二单元",
                                    "lessons": [
                                        {"name": "第四课", "topic": "饮食文化"}, {"name": "第五课", "topic": "饮食文化"}, {"name": "第六课", "topic": "饮食文化"}
                                    ]
                                },
                                {
                                    "name": "第三单元",
                                    "lessons": [
                                        {"name": "第七课", "topic": "饮食文化"}, {"name": "第八课", "topic": "饮食文化"}, {"name": "第九课", "topic": "饮食文化"}
                                    ]
                                },
                                {
                                    "name": "第四单元",
                                    "lessons": [
                                        {"name": "第十课", "topic": "饮食文化"}, {"name": "第十一课", "topic": "饮食文化"}, {"name": "第十二课", "topic": "饮食文化"}
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "第二册",
                            "units": [
                                {
                                    "name": "第一单元",
                                    "lessons": [
                                        {"name": "第一课", "topic": "饮食文化"}, {"name": "第二课", "topic": "饮食文化"}, {"name": "第三课", "topic": "饮食文化"}
                                    ]
                                },
                                {
                                    "name": "第二单元",
                                    "lessons": [
                                        {"name": "第四课", "topic": "饮食文化"}, {"name": "第五课", "topic": "饮食文化"}, {"name": "第六课", "topic": "饮食文化"}
                                    ]
                                },
                                {
                                    "name": "第三单元",
                                    "lessons": [
                                        {"name": "第七课", "topic": "饮食文化"}, {"name": "第八课", "topic": "饮食文化"}, {"name": "第九课", "topic": "饮食文化"}
                                    ]
                                },
                                {
                                    "name": "第四单元",
                                    "lessons": [
                                        {"name": "第十课", "topic": "饮食文化"}, {"name": "第十一课", "topic": "饮食文化"}, {"name": "第十二课", "topic": "饮食文化"}
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "第三册",
                            "units": [
                                {
                                    "name": "第一单元",
                                    "lessons": [
                                        {"name": "第一课", "topic": "饮食文化"}, {"name": "第二课", "topic": "饮食文化"}, {"name": "第三课", "topic": "饮食文化"}
                                    ]
                                },
                                {
                                    "name": "第二单元",
                                    "lessons": [
                                        {"name": "第四课"}, {"name": "第五课"}, {"name": "第六课"}
                                    ]
                                },
                                {
                                    "name": "第三单元",
                                    "lessons": [
                                        {"name": "第七课"}, {"name": "第八课"}, {"name": "第九课"}
                                    ]
                                },
                                {
                                    "name": "第四单元",
                                    "lessons": [
                                        {"name": "第十课"}, {"name": "第十一课"}, {"name": "第十二课"}
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "第四册",
                            "units": [
                                {
                                    "name": "第一单元",
                                    "lessons": [
                                        {"name": "第一课"}, {"name": "第二课"}, {"name": "第三课"}
                                    ]
                                },
                                {
                                    "name": "第二单元",
                                    "lessons": [
                                        {"name": "第四课"}, {"name": "第五课"}, {"name": "第六课"}
                                    ]
                                },
                                {
                                    "name": "第三单元",
                                    "lessons": [
                                        {"name": "第七课"}, {"name": "第八课"}, {"name": "第九课"}
                                    ]
                                },
                                {
                                    "name": "第四单元",
                                    "lessons": [
                                        {"name": "第十课"}, {"name": "第十一课"}, {"name": "第十二课"}
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "第五册",
                            "units": [
                                {
                                    "name": "第一单元",
                                    "lessons": [
                                        {"name": "第一课"}, {"name": "第二课"}, {"name": "第三课"}
                                    ]
                                },
                                {
                                    "name": "第二单元",
                                    "lessons": [
                                        {"name": "第四课"}, {"name": "第五课"}, {"name": "第六课"}
                                    ]
                                },
                                {
                                    "name": "第三单元",
                                    "lessons": [
                                        {"name": "第七课"}, {"name": "第八课"}, {"name": "第九课"}
                                    ]
                                },
                                {
                                    "name": "第四单元",
                                    "lessons": [
                                        {"name": "第十课"}, {"name": "第十一课"}, {"name": "第十二课"}
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "第六册",
                            "units": [
                                {
                                    "name": "第一单元",
                                    "lessons": [
                                        {"name": "第一课"}, {"name": "第二课"}, {"name": "第三课"}
                                    ]
                                },
                                {
                                    "name": "第二单元",
                                    "lessons": [
                                        {"name": "第四课"}, {"name": "第五课"}, {"name": "第六课"}
                                    ]
                                },
                                {
                                    "name": "第三单元",
                                    "lessons": [
                                        {"name": "第七课"}, {"name": "第八课"}, {"name": "第九课"}
                                    ]
                                },
                                {
                                    "name": "第四单元",
                                    "lessons": [
                                        {"name": "第十课"}, {"name": "第十一课"}, {"name": "第十二课"}
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "华文（小学·北京华文学院版）",
                    "icon": "fas fa-school",
                    "volumes": [
                        {
                            "name": "第一册",
                            "units": [
                                {
                                    "name": "第一单元",
                                    "lessons": [
                                        {"name": "第一课"}, {"name": "第二课"}, {"name": "第三课"}, {"name": "第四课"}, {"name": "第五课"}
                                    ]
                                },
                                {
                                    "name": "第二单元",
                                    "lessons": [
                                        {"name": "第六课"}, {"name": "第七课"}, {"name": "第八课"}, {"name": "第九课"}, {"name": "第十课"}
                                    ]
                                },
                                {
                                    "name": "第三单元",
                                    "lessons": [
                                        {"name": "第十一课"}, {"name": "第十二课"}, {"name": "第十三课"}, {"name": "第十四课"}, {"name": "第十五课"}
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "第二册",
                            "units": [
                                {
                                    "name": "第一单元",
                                    "lessons": [
                                        {"name": "第一课"}, {"name": "第二课"}, {"name": "第三课"}, {"name": "第四课"}, {"name": "第五课"}
                                    ]
                                },
                                {
                                    "name": "第二单元",
                                    "lessons": [
                                        {"name": "第六课"}, {"name": "第七课"}, {"name": "第八课"}, {"name": "第九课"}, {"name": "第十课"}
                                    ]
                                },
                                {
                                    "name": "第三单元",
                                    "lessons": [
                                        {"name": "第十一课"}, {"name": "第十二课"}, {"name": "第十三课"}, {"name": "第十四课"}, {"name": "第十五课"}
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "第三册",
                            "units": [
                                {
                                    "name": "第一单元",
                                    "lessons": [
                                        {"name": "第一课"}, {"name": "第二课"}, {"name": "第三课"}, {"name": "第四课"}, {"name": "第五课"}
                                    ]
                                },
                                {
                                    "name": "第二单元",
                                    "lessons": [
                                        {
                                            "name": "第六课",
                                            "games": [
                                                {"name": "句子练习", "url": "https://wordwall.net/resource/80168255/", "type": "Wordwall"},
                                                {"name": "字词理解", "url": "https://wordwall.net/resource/80167546/", "type": "Wordwall"},
                                                {"name": "字词认读", "url": "https://wordwall.net/resource/80165456/", "type": "Wordwall"}
                                            ]
                                        },
                                        {
                                            "name": "第七课", 
                                            "games": [
                                                {"name": "字词理解", "url": "https://wordwall.net/resource/80068616", "type": "Wordwall"},
                                                {"name": "量词练习", "url": "https://wordwall.net/resource/80224277", "type": "Wordwall"},
                                                {"name": "字词理解", "url": "https://wordwall.net/resource/80227582", "type": "Wordwall"},
                                                {"name": "句子练习", "url": "https://wordwall.net/resource/80228243", "type": "Wordwall"}
                                            ]
                                        },
                                        {
                                            "name": "第八课",
                                            "games": [
                                                {"name": "字词认读", "url": "https://wordwall.net/resource/80168690", "type": "Wordwall"},
                                                {"name": "字词理解", "url": "https://wordwall.net/resource/80638505", "type": "Wordwall"},
                                                {"name": "句子练习", "url": "https://wordwall.net/resource/80640611", "type": "Wordwall"},
                                                {"name": "偏旁练习", "url": "https://wordwall.net/resource/80645634", "type": "Wordwall"}
                                            ]
                                        },
                                        {
                                            "name": "第九课",
                                            "games": [
                                                {"name": "听力练习", "url": "https://wordwall.net/resource/84780864", "type": "Wordwall"},
                                                {"name": "词语理解", "url": "https://wordwall.net/resource/84781056/", "type": "Wordwall"},
                                                {"name": "句子练习", "url": "https://wordwall.net/resource/86360358", "type": "Wordwall"}
                                            ]
                                        },
                                        {
                                            "name": "第十课",
                                            "games": [
                                                {"name": "句子练习", "url": "https://wordwall.net/resource/86360533", "type": "Wordwall"},
                                                {"name": "字词理解", "url": "https://wordwall.net/resource/86360659", "type": "Wordwall"}
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "name": "第三单元", 
                                    "lessons": [
                                        {"name": "第十一课"},
                                        {"name": "第十二课"},
                                        {
                                            "name": "第十三课",
                                            "games": [
                                                {"name": "词语学习", "url": "https://quizlet.com/ie/1087671959/%E7%AC%AC13%E8%AF%BE%E7%88%B7%E7%88%B7%E5%8E%BB%E5%85%AC%E5%9B%AD%E6%89%93%E5%A4%AA%E6%9E%81%E6%8B%B3-flash-cards/?i=3vrcho&x=1qqt", "type": "Quizlet"},
                                                {"name": "拼音认读", "url": "https://wordwall.net/resource/99422538", "type": "Wordwall"},
                                                {"name": "词语理解", "url": "https://wordwall.net/resource/97903998", "type": "Wordwall"},
                                                {"name": "读音意思配对1", "url": "https://wordwall.net/resource/97910875", "type": "Wordwall"},
                                                {"name": "读音意思配对2", "url": "https://wordwall.net/resource/97911125", "type": "Wordwall"},
                                                {"name": "读音意思配对3", "url": "https://wordwall.net/resource/97911124", "type": "Wordwall"},
                                                {"name": "读音意思配对4", "url": "https://wordwall.net/resource/97911415", "type": "Wordwall"},
                                                {"name": "句子练习", "url": "https://wordwall.net/resource/97927837", "type": "Wordwall"}
                                            ]
                                        },
                                        {
                                            "name": "第十四课",
                                            "games": [
                                                {"name": "词语学习--读音", "url": "https://quizlet.com/ie/1091007279/%E4%B8%8914%E6%88%91%E4%BB%AC%E5%9D%90%E8%BD%A6%E5%8E%BB%E5%8A%A8%E7%89%A9%E5%9B%AD-flash-cards/?i=3vrcho&x=1jqt", "type": "Quizlet"},
                                                {"name": "词语学习--读音", "url": "https://quizlet.com/ie/1094618452/%E4%B8%8914%E6%88%91%E4%BB%AC%E5%9D%90%E8%BD%A6%E5%8E%BB%E5%8A%A8%E7%89%A9%E5%9B%AD-%E7%90%86%E8%A7%A3-flash-cards/?i=3vrcho&x=1jqt", "type": "Quizlet"}
                                            ]
                                        },
                                        {
                                            "name": "第十五课",
                                            "games": [
                                                {"name": "词语练习--理解", "url": "https://quizlet.com/ie/1094704526/%E4%B8%8915%E5%A4%A7%E5%AE%B6%E5%8E%BB%E9%83%8A%E6%B8%B8-%E7%90%86%E8%A7%A3-flash-cards/?i=3vrcho&x=1jqt", "type": "Quizlet"},
                                                {"name": "词语练习--读音", "url": "https://quizlet.com/ie/1094668136/%E4%B8%8915%E5%A4%A7%E5%AE%B6%E5%8E%BB%E9%83%8A%E6%B8%B8-%E6%8B%BC%E9%9F%B3-flash-cards/?i=3vrcho&x=1jqt", "type": "Quizlet"},
                                                {"name": "打字练习（till 31/10/2025）", "url": "https://play.blooket.com/play?hwId=68f3bf18d6efdb7822cf0fc6", "type": "Blooket"},
                                                {"name": "听力练习1", "url": "https://wordwall.net/resource/100000252", "type": "Wordwall"},
                                                {"name": "听力练习2", "url": "https://wordwall.net/resource/100000464", "type": "Wordwall"}
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "YCT标准教程",
                    "icon": "fas fa-graduation-cap",
                    "volumes": [
                        {
                            "name": "第一册",
                            "units": [
                                {
                                    "name": "全册12课",
                                    "lessons": [
                                        {"name": "Lesson 1"}, {"name": "Lesson 2"}, {"name": "Lesson 3"}, {"name": "Lesson 4"},
                                        {"name": "Lesson 5"}, {"name": "Lesson 6"}, {"name": "Lesson 7"}, {"name": "Lesson 8"},
                                        {"name": "Lesson 9"}, {"name": "Lesson 10"}, {"name": "Lesson 11"}, {"name": "Lesson 12"}
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "第二册",
                            "units": [
                                {
                                    "name": "全册12课",
                                    "lessons": [
                                        {"name": "Lesson 1"}, {"name": "Lesson 2"}, {"name": "Lesson 3"}, {"name": "Lesson 4"},
                                        {"name": "Lesson 5"}, {"name": "Lesson 6"}, {"name": "Lesson 7"}, {"name": "Lesson 8"},
                                        {"name": "Lesson 9"}, {"name": "Lesson 10"}, {"name": "Lesson 11"}, {"name": "Lesson 12"}
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "第三册",
                            "units": [
                                {
                                    "name": "全册12课",
                                    "lessons": [
                                        {"name": "Lesson 1"}, {"name": "Lesson 2"}, {"name": "Lesson 3"}, {"name": "Lesson 4"},
                                        {"name": "Lesson 5"}, {"name": "Lesson 6"}, {"name": "Lesson 7"}, {"name": "Lesson 8"},
                                        {"name": "Lesson 9"}, {"name": "Lesson 10"}, {"name": "Lesson 11"}, {"name": "Lesson 12"}
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "第四册",
                            "units": [
                                {
                                    "name": "全册12课",
                                    "lessons": [
                                        {"name": "Lesson 1"}, {"name": "Lesson 2"}, {"name": "Lesson 3"}, {"name": "Lesson 4"},
                                        {"name": "Lesson 5"}, {"name": "Lesson 6"}, {"name": "Lesson 7"}, {"name": "Lesson 8"},
                                        {"name": "Lesson 9"}, {"name": "Lesson 10"}, {"name": "Lesson 11"}, {"name": "Lesson 12"}
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "第五册",
                            "units": [
                                {
                                    "name": "全册12课",
                                    "lessons": [
                                        {"name": "Lesson 1"}, {"name": "Lesson 2"}, {"name": "Lesson 3"}, {"name": "Lesson 4"},
                                        {"name": "Lesson 5"}, {"name": "Lesson 6"}, {"name": "Lesson 7"}, {"name": "Lesson 8"},
                                        {"name": "Lesson 9"}, {"name": "Lesson 10"}, {"name": "Lesson 11"}, {"name": "Lesson 12"}
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "第六册",
                            "units": [
                                {
                                    "name": "全册12课",
                                    "lessons": [
                                        {"name": "Lesson 1"}, {"name": "Lesson 2"}, {"name": "Lesson 3"}, {"name": "Lesson 4"},
                                        {"name": "Lesson 5"}, {"name": "Lesson 6"}, {"name": "Lesson 7"}, {"name": "Lesson 8"},
                                        {"name": "Lesson 9"}, {"name": "Lesson 10"}, {"name": "Lesson 11"}, {"name": "Lesson 12"}
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
    "name": "幼儿汉语",
    "icon": "fas fa-child",
    "volumes": [
        {
            "name": "第一册",
            "units": [
                {
                    "name": "全册10课",
                    "lessons": [
                        {"name": "一"}, {"name": "二"}, {"name": "三"}, {"name": "四"},
                        {"name": "五"}, {"name": "六"}, {"name": "七"}, {"name": "八"},
                        {"name": "九"}, {"name": "十"}
                    ]
                }
            ]
        },
        {
            "name": "第二册",
            "units": [
                {
                    "name": "全册10课",
                    "lessons": [
                        {
                            "name": "一",
                            "topic": "这是电脑",
                            "games": [
                                {"name": "字词认读", "url": "https://wordwall.net/resource/81477553", "type": "Wordwall"},
                                {"name": "听力练习", "url": "https://wordwall.net/resource/97731750", "type": "Wordwall"}
                            ]
                        },
                        {
                            "name": "二",
                            "topic": "那是什么",
                            "games": [
                                {"name": "听力训练", "url": "https://wordwall.net/resource/81952033", "type": "Wordwall"},
                                {"name": "字词理解", "url": "https://wordwall.net/resource/81951745", "type": "Wordwall"}
                            ]
                        },
                        {
                            "name": "三",
                            "topic": "你吃什么",
                            "games": [
                                {"name": "字词认读", "url": "https://wordwall.net/resource/82095839", "type": "Wordwall"},
                                {"name": "听力练习", "url": "https://wordwall.net/resource/99173199", "type": "Wordwall"},
                                {"name": "字词理解", "url": "https://wordwall.net/resource/99173572", "type": "Wordwall"}
                            ]
                        },
                        {
                            "name": "四",
                            "topic": "你喝什么",
                            "games": [
                                {"name": "句子练习", "url": "https://wordwall.net/resource/83337036", "type": "Wordwall"},
                                {"name": "字词练习", "url": "https://wordwall.net/resource/83336767", "type": "Wordwall"}
                            ]
                        },
                        {
                            "name": "五",
                            "topic": "妈妈在哪里",
                            "games": [
                                {"name": "字词认读", "url": "https://wordwall.net/resource/83743039", "type": "Wordwall"},
                                {"name": "听力练习", "url": "https://wordwall.net/resource/85484951", "type": "Wordwall"}
                            ]
                        },
                        {
                            "name": "六",
                            "topic": "你去哪里",
                            "games": [
                                {"name": "听力练习", "url": "https://wordwall.net/resource/85485909", "type": "Wordwall"},
                                {"name": "字词理解", "url": "https://wordwall.net/resource/86438814", "type": "Wordwall"}
                            ]
                        },
                        {
                            "name": "七",
                            "topic": "你有风筝吗",
                            "games": [
                                {"name": "字词理解", "url": "https://wordwall.net/resource/86440206", "type": "Wordwall"},
                                {"name": "听力训练", "url": "https://wordwall.net/resource/86443069", "type": "Wordwall"}
                            ]
                        },
                        {
                            "name": "八",
                            "topic": "我有三个气球",
                            "games": [
                                {"name": "数字读音", "url": "https://wordwall.net/resource/86716150", "type": "Wordwall"},
                                {"name": "数字理解", "url": "https://wordwall.net/resource/86716096", "type": "Wordwall"},
                                {"name": "字词理解", "url": "https://wordwall.net/resource/86716532", "type": "Wordwall"}
                            ]
                        },
                        {
                            "name": "九",
                            "topic": "你有几个苹果",
                            "games": [
                                {"name": "字词理解", "url": "https://wordwall.net/resource/87302648", "type": "Wordwall"},
                                {"name": "听力练习", "url": "https://wordwall.net/resource/87302795", "type": "Wordwall"}
                            ]
                        },
                        {
                            "name": "十",
                            "topic": "他有围巾和帽子",
                            "games": [
                                {"name": "听力练习", "url": "https://wordwall.net/resource/87854600", "type": "Wordwall"},
                                {"name": "听力练习2", "url": "https://wordwall.net/resource/87854656", "type": "Wordwall"},
                                {"name": "词语理解", "url": "https://wordwall.net/resource/87855317", "type": "Wordwall"},
                                {"name": "句子总复习", "url": "https://wordwall.net/resource/88415263", "type": "Wordwall"}
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "name": "第三册",
            "units": [
                {
                    "name": "全册10课",
                    "lessons": [
                        {"name": "一"}, {"name": "二"}, {"name": "三"}, {"name": "四"},
                        {"name": "五"}, {"name": "六"}, {"name": "七"}, {"name": "八"},
                        {"name": "九"}, {"name": "十"}
                    ]
                }
            ]
        }
    ]
}
            ];

            // 从外部JSON文件加载数据
            async function loadTextbooksData() {
                try {
                    // 尝试从外部JSON文件加载
                    const response = await fetch('data.json');
                    if (response.ok) {
                        return await response.json();
                    }
                } catch (error) {
                    console.log('无法加载外部数据文件，使用内置数据');
                }
                
                // 如果外部文件加载失败，使用完整的内置数据
                return completeTextbooksData;
            }

            // 渲染教材卡片
            function renderTextbooks(data) {
                const container = document.getElementById('textbooksContainer');
                
                // 先调整布局
                adjustTextbooksLayout(data);
                
                if (data.length === 0) {
                    container.innerHTML = '<div class="no-results">没有找到匹配的教材</div>';
                    return;
                }
                
                container.innerHTML = data.map(textbook => {
                    const totalVolumes = textbook.volumes.length;
                    const totalLessons = textbook.volumes.reduce((sum, volume) => {
                        return sum + volume.units.reduce((unitSum, unit) => unitSum + unit.lessons.length, 0);
                    }, 0);
                    
                    return `
                        <div class="textbook-card" data-textbook="${textbook.name}">
                            <div class="textbook-header">
                                <h2>${textbook.name}</h2>
                                <div class="textbook-count">${totalVolumes}册 ${totalLessons}课</div>
                                <i class="${textbook.icon} textbook-icon"></i>
                            </div>
                            <div class="volumes-container">
                                ${textbook.volumes.map(volume => {
                                    const volumeLessons = volume.units.reduce((sum, unit) => sum + unit.lessons.length, 0);
                                    
                                    return `
                                        <div class="volume-item">
                                            <div class="volume-header">
                                                <h3>${volume.name}</h3>
                                                <span class="volume-toggle"><i class="fas fa-chevron-down"></i></span>
                                            </div>
                                            <div class="units-container">
                                                ${volume.units.map(unit => {
                                                    return `
                                                        <div class="unit-item">
                                                            <div class="unit-header">
                                                                <span class="unit-name">${unit.name}</span>
                                                                <span class="lessons-count">${unit.lessons.length}课</span>
                                                            </div>
                                                            ${unit.topic ? `<div class="unit-topic">${unit.topic}</div>` : ''}
                                                            ${unit.lessons.length > 0 ? 
                                                                `<div class="lessons-container">
                                                                    ${unit.lessons.map(lesson => 
                                                                        `<div class="lesson-item ${lesson.games && lesson.games.length > 0 ? 'has-games' : ''}">
                                                                            <div class="lesson-header">
                                                                                <div class="lesson-name">${lesson.name}</div>
                                                                                ${lesson.topic ? `<div class="lesson-title">${lesson.topic}</div>` : ''}
                                                                                ${lesson.games && lesson.games.length > 0 ? 
                                                                                    `<span class="games-toggle"><i class="fas fa-chevron-down"></i></span>` : 
                                                                                    ''
                                                                                }
                                                                            </div>
                                                                            ${lesson.games && lesson.games.length > 0 ? 
                                                                                `<div class="games-container">
                                                                                    <div class="games-title">游戏链接 (${lesson.games.length})</div>
                                                                                    ${lesson.games.map(game => 
                                                                                        `<a href="${game.url}" target="_blank" class="game-link">
                                                                                            <i class="fas fa-gamepad"></i> ${game.name}
                                                                                            ${game.type ? `<span class="game-type">${game.type}</span>` : ''}
                                                                                        </a>`
                                                                                    ).join('')}
                                                                                </div>` : 
                                                                                ''
                                                                            }
                                                                        </div>`
                                                                    ).join('')}
                                                                </div>` : 
                                                                `<div class="empty-lessons">暂无课程内容</div>`
                                                            }
                                                        </div>
                                                    `;
                                                }).join('')}
                                            </div>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>
                    `;
                }).join('');
                
                // 添加卷的展开/收起功能
                document.querySelectorAll('.volume-header').forEach(header => {
                    header.addEventListener('click', () => {
                        const container = header.nextElementSibling;
                        const toggle = header.querySelector('.volume-toggle');
                        
                        container.classList.toggle('expanded');
                        toggle.classList.toggle('rotated');
                    });
                });

                // 添加游戏链接的展开/收起功能
                function setupGameLinks() {
                    document.querySelectorAll('.lesson-header').forEach(header => {
                        if (header.querySelector('.games-toggle')) {
                            header.addEventListener('click', (e) => {
                                e.stopPropagation();
                                
                                const container = header.nextElementSibling;
                                const toggle = header.querySelector('.games-toggle');
                                
                                if (container && container.classList.contains('games-container')) {
                                    container.classList.toggle('expanded');
                                    toggle.classList.toggle('rotated');
                                }
                            });
                        }
                    });
                }

                // 调用设置游戏链接功能
                setupGameLinks();
            }

            // 搜索功能
            function setupSearch() {
                const searchInput = document.getElementById('searchInput');
                
                searchInput.addEventListener('input', () => {
                    const searchTerm = searchInput.value.toLowerCase();
                    
                    if (searchTerm === '') {
                        renderTextbooks(window.textbooksData);
                        return;
                    }
                    
                    const filteredData = window.textbooksData.map(textbook => {
                        if (textbook.name.toLowerCase().includes(searchTerm)) {
                            return textbook;
                        }
                        
                        const filteredVolumes = textbook.volumes.map(volume => {
                            if (volume.name.toLowerCase().includes(searchTerm)) {
                                return volume;
                            }
                            
                            const filteredUnits = volume.units.map(unit => {
                                if (unit.name.toLowerCase().includes(searchTerm) || 
                                    (unit.topic && unit.topic.toLowerCase().includes(searchTerm))) {
                                    return unit;
                                }
                                
                                const filteredLessons = unit.lessons.filter(lesson => {
                                    const lessonMatch = lesson.name.toLowerCase().includes(searchTerm);
                                    const topicMatch = lesson.topic && lesson.topic.toLowerCase().includes(searchTerm);
                                    return lessonMatch || topicMatch;
                                });
                                
                                if (filteredLessons.length > 0) {
                                    return {...unit, lessons: filteredLessons};
                                }
                                
                                return null;
                            }).filter(unit => unit !== null);
                            
                            if (filteredUnits.length > 0) {
                                return {...volume, units: filteredUnits};
                            }
                            
                            return null;
                        }).filter(volume => volume !== null);
                        
                        if (filteredVolumes.length > 0) {
                            return {...textbook, volumes: filteredVolumes};
                        }
                        
                        return null;
                    }).filter(textbook => textbook !== null);
                    
                    renderTextbooks(filteredData);
                });
            }

            // 筛选功能
            function setupFilters() {
                const filterButtons = document.querySelectorAll('.filter-btn');
                
                filterButtons.forEach(button => {
                    button.addEventListener('click', () => {
                        filterButtons.forEach(btn => btn.classList.remove('active'));
                        button.classList.add('active');
                        
                        const filter = button.getAttribute('data-filter');
                        
                        if (filter === 'all') {
                            renderTextbooks(window.textbooksData);
                        } else {
                            let filteredData = [];
                            
                            switch(filter) {
                                case '欧洲版':
                                    filteredData = window.textbooksData.filter(t => t.name.includes('欧洲版'));
                                    break;
                                case '暨南大学版':
                                    filteredData = window.textbooksData.filter(t => t.name.includes('暨南大学版'));
                                    break;
                                case '华文':
                                    filteredData = window.textbooksData.filter(t => t.name.includes('华文'));
                                    break;
                                case 'YCT':
                                    filteredData = window.textbooksData.filter(t => t.name.includes('YCT'));
                                    break;
                                case '幼儿汉语':
                                    filteredData = window.textbooksData.filter(t => t.name.includes('幼儿汉语'));
                                    break;
                                case '汉语拼音':
                                    filteredData = window.textbooksData.filter(t => t.name.includes('汉语拼音'));
                                    break;
                            }
                            
                            renderTextbooks(filteredData);
                        }
                    });
                });
            }

            // 初始化主网站
            window.textbooksData = completeTextbooksData;
            renderTextbooks(window.textbooksData);
            setupSearch();
            setupFilters();
        }
    </script>
</body>
</html>



